Домашнее задание по теме "Hashicorp Vault // ДЗ"

Данное задание реализовано при помощи готового кластера k3s, поднятого в прошлом ДЗ:

Инструкция по настройке ВМ:

2. Переходим в директорию с проектом ansible
```
cd ./ansible/
```
3. Запускаем автоматизацию при помощи ansible для каждой из групп хостов
```
ansible-playbook -i inventories/k3s/main.yml main.yml
```

Absible деплоит деплоит через helm кластер vault (vault деплоится повторно в свои же pv в longhorn, джойнить ноды не нужно, только распечатать), производитс настройка k8s аутентификации. После поднятия кластера vault поднимается веб приложение (wordpress + mysql), без определения утетных данный для подключения. Финальным этапом настраивается коннектор между vault и mysql. Ротация УЗ в mysql осуществляется через прямую интеграцию vault-mysql. Доставка данных УЗ в wordpress осуществляется через vault-inject, который поднимает в поде с wordpress vault-agent, который в свою очередь складывает УЗ в локальный для контейнера файл. Далее wordpress благодаря модифицированному wp-config.php осуществляет ротацию УЗ для подключения к БД.



На вложенных скриншотах отражены основные этапы выполнения ДЗ:

homework-13-1.png: состояние кластера и основных объектов

homework-13-2.png: демонстрация ротации УЗ внутри mysql и wordpress в одинаковое время

homework-13-3.png: веб страница портала
